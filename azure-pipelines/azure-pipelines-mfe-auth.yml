trigger:
  branches:
    include:
      - main
      - feature/*
      - fix/*
  paths:
    include:
      - "mfe-host/*"

pool:
  vmImage: $(vmImageName)

variables:
  - template: templates/variables-template
    parameters:
      appName: "mfe-host"
      appArtifactName: "mfe-host"
      appArtifactPath: "mfe-host"
      environmentName: "mfe-host"

stages:
  - template: templates/build-template.yml
    parameters:
      stageName: build-${{ variables.appArtifactName }}
      stageDisplayName: Build and publish artifact ${{ variables.appName }}

  - template: templates/deploy-function-type-template.yml
    parameters:
      stageName: dev-${{ variables.appArtifactName }}
      stageDisplayName: Dev environment ${{ variables.appName }}

  - template: templates/deploy-web-app-type-template.yml
    parameters:
      stageName: deploy-${{ variables.appArtifactName }}
      stageDisplayName: Deploy stage ${{ variables.appName }}
