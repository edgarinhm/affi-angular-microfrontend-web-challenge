stages:
  - stage: ${{ parameters.stageName }}
    displayName: ${{ parameters.stageDisplayName }}
    dependsOn: ${{ parameters.stageDependsOn}}
    condition: succeeded()
    jobs:
      - deployment: DeployWebApp
        displayName: "Deploy ${{ parameters.appName }}"
        environment: ${{ parameters.environmentName}}
        strategy:
          runOnce:
            deploy:
              steps:
                - task: AzureWebApp@1
                  displayName: "Azure Web App Deploy: $(appName)"
                  inputs:
                    azureSubscription: $(appAzureSubscription)
                    appType: webAppLinux
                    appName: $(appName)
                    package: $(Pipeline.Workspace)/drop/${{ parameters.appArtifactPath }}-$(Build.BuildId).zip
                    runtimeStack: $(deployRuntimeStack)
